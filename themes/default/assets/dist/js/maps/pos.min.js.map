{"version":3,"sources":["pos.js"],"names":["add_invoice_item","item","count","spositems","item_id","Settings","item_addition","id","row","qty","parseFloat","store","JSON","stringify","loadItems","get","total","an","product_tax","invoice_tax","product_discount","order_discount","total_discount","$","empty","time","Date","getTime","remote_printing","ob_info","pos_customer","text","hr","val","user","username","pos_curr_time","date","dateformat","timeformat","order_data","info","bill_data","o_items","b_items","style","pos_head","site_name","prepend","lang","order","bill","parse","each","this","product_id","item_type","type","item_tax_method","tax_method","combo_items","item_qty","item_aqty","quantity","item_ds","discount","item_code","code","item_name","name","replace","net_price","real_unit_price","item_comment","comment","item_was_ordered","ordered","ds","item_discount","formatDecimal","indexOf","pds","split","isNaN","pr_tax","tax","pr_tax_val","inclusive","exclusive","row_no","newTr","tr_html","formatMoney","html","prependTo","oitb","scrollHeight","slimScroll","scrollTo","addClass","find","removeClass","comments","i","len","length","printLine","bprTr","oprTr","append","ts","order_tax","pts","g_total","grand_total","items","b_totals","rounding","round_total","roundNumber","parseInt","total_payable","total_items","totals","bill_totals","merchant_copy","display_kb","display_keyboards","focus","chr","String","fromCharCode","jQuery","browser","mobile","keyboard","autoAccept","alwaysOpen","openOn","usePreview","layout","display","bksp","accept","default","meta1","meta2","customLayout","shift","restrictInput","preventPaste","b","calTax","nav_pointer","pp","p_page","attr","pro_limit","tcp","Popup","data","createWin","then","w","close","Promise","resolve","d","assets","mywindow","window","open","document","write","setTimeout","posScreen","wh","height","total_dh","buttons_dh","items_dh","list_table_dh","outerHeight","str","size","char_per_line","res","newd","read_card","ready","on","e","preventDefault","stopPropagation","hideseek","nodata","no_match_found","n","modal","closest","item_rid","unit_price","console","log","base_url","label","row_id","backdrop","price","is_valid_discount","bootbox","alert","unexpected_value","localStorage","setItem","is_numeric","new_qty","click","protect_delete","dialog","title","enter_pin_code","closeButton","message","buttons","danger","className","callback","success","delete","md5","pin_code","remove","location","href","wrong_pin","keypress","keyCode","trigger","confirm","r_u_sure","result","please_add_product","show","print_img","element","html2canvas","scrollY","scale","canvas","img","toDataURL","post","spos_token","csrf_hash","form","serialize","printOrder","hide","printBill","apply_to","dval","focusToEnd","tval","ajax","url","dataType","cid","cat_id","category_id","products","per_page","autocomplete","source","minLength","autoFocus","delay","response","event","ui","content","_trigger","select","bind","inputmask","placeholder","no","generateCardNo","parent","children","gccode","gcname","gcvalue","gcprice","gcexpiry","file_required_fields","gc_data","Array","gcdata","hasOwnProperty","ref","type_reference_note","suspend","sid","appendTo","submit","gtotal","change","total_paying","total_paid","p_val","rounded_total","slideDown","slideUp","cn","async","balance","incorrect_gift_card","card_no","value","paying","$quick_cash","amt","contents","filter","nodeType","th","thousands_sep","$pi","join","note_count","spos_note","spos_customer","select2","hover","top","offset","menu","target","hasClass","hold_ref","status","msg","error","customer_request_failed","start","width","extend","keyaction","enter","base","$el","is","insertText","TrackData","p","SwipeParserObj","hasTrack1","CardType","ccn1","account","charAt","account_name","exp_month","exp_year","blur","removeData","clear","reload","focus_add_item","shortcut","add","propagate","add_customer","toggle_category_slider","cancel_sale","suspend_sale","print_order","print_bill","finalize_sale","today_sale","open_hold_bills","close_register","fn","v","ajaxSetup","cache","headers","cache-control"],"mappings":"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","file":"../pos.min.js","sourcesContent":["function add_invoice_item(item) {\n    if (count == 1) {\n        spositems = {};\n    }\n    if (item == null) {\n        return;\n    }\n\n    var item_id = Settings.item_addition == 1 ? item.item_id : item.id;\n    if (spositems[item_id]) {\n        spositems[item_id].row.qty = parseFloat(spositems[item_id].row.qty) + 1;\n    } else {\n        spositems[item_id] = item;\n    }\n\n    store('spositems', JSON.stringify(spositems));\n    loadItems();\n    return true;\n}\n\nfunction loadItems() {\n    if (count == 1) {\n        spositems = {};\n    }\n    if (get('spositems')) {\n        total = 0;\n        count = 1;\n        an = 1;\n        product_tax = 0;\n        invoice_tax = 0;\n        product_discount = 0;\n        order_discount = 0;\n        total_discount = 0;\n\n        $('#posTable tbody').empty();\n        var time = new Date().getTime() / 1000;\n        if (Settings.remote_printing != 1) {\n            var pos_customer = 'C: ' + $('#select2-spos_customer-container').text() + '\\n';\n            var hr = 'R: ' + $('#hold_ref').val() + '\\n';\n            var user = 'U: ' + username + '\\n';\n            var pos_curr_time = 'T: ' + date(Settings.dateformat + ' ' + Settings.timeformat, time) + '\\n';\n            var ob_info = pos_customer + hr + user + pos_curr_time + '\\n';\n            order_data.info = ob_info;\n            bill_data.info = ob_info;\n            var o_items = '';\n            var b_items = '';\n        } else {\n            $('#order_span').empty();\n            $('#bill_span').empty();\n            var style = '<style>.bb td, .bb th { border-bottom: 1px solid #DDD; }</style>';\n            var pos_head = '<span style=\"text-align:center;\"><h3>' + Settings.site_name + '</h3>';\n            // var pos_customer = ''; // remove this line and uncomment below to display customer\n            var pos_customer = '<h5>C: ' + $('#select2-spos_customer-container').text() + '</h5>';\n            var hr = '<h5>R: ' + $('#hold_ref').val() + '</h5>';\n            var user = '<h5>U: ' + username + '</h5>';\n            var pos_curr_time = '<h5>T: ' + date(Settings.dateformat + ' ' + Settings.timeformat, time) + '</h5>';\n            $('#order_span').prepend(style + pos_head + '<h4>' + lang.order + '</h4></span>' + pos_customer + hr + user + pos_curr_time);\n            $('#bill_span').prepend(style + pos_head + '<h4>' + lang.bill + '</h4></span>' + pos_customer + hr + user + pos_curr_time);\n            $('#order-table').empty();\n            $('#bill-table').empty();\n        }\n        spositems = JSON.parse(get('spositems'));\n\n        $.each(spositems, function() {\n            var item = this;\n            var item_id = Settings.item_addition == 1 ? item.item_id : item.id;\n            spositems[item_id] = item;\n\n            var product_id = item.row.id,\n                item_type = item.row.type,\n                item_tax_method = parseFloat(item.row.tax_method),\n                combo_items = item.combo_items,\n                item_qty = item.row.qty,\n                item_aqty = parseFloat(item.row.quantity),\n                item_type = item.row.type,\n                item_ds = item.row.discount,\n                item_code = item.row.code,\n                item_name = item.row.name.replace(/\"/g, '&#034;').replace(/'/g, '&#039;');\n            var unit_price = parseFloat(item.row.real_unit_price);\n            var net_price = unit_price;\n            var item_comment = item.row.comment;\n            var item_was_ordered = item.row.ordered ? item.row.ordered : 0;\n\n            var ds = item_ds ? item_ds : '0';\n            var item_discount = formatDecimal(ds);\n            if (ds.indexOf('%') !== -1) {\n                var pds = ds.split('%');\n                if (!isNaN(pds[0])) {\n                    item_discount = formatDecimal(parseFloat((net_price * parseFloat(pds[0])) / 100), 4);\n                }\n            }\n            product_discount += formatDecimal(item_discount * item_qty, 4);\n            net_price = formatDecimal(net_price - item_discount, 4);\n\n            var pr_tax = parseFloat(item.row.tax),\n                pr_tax_val = 0;\n            if (pr_tax !== null && pr_tax != 0) {\n                if (item_tax_method == 0) {\n                    pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100 + parseFloat(pr_tax)), 4);\n                    net_price -= pr_tax_val;\n                    tax = lang.inclusive;\n                } else {\n                    pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100, 4);\n                    tax = lang.exclusive;\n                }\n            }\n            product_tax += formatDecimal(pr_tax_val * item_qty, 4);\n\n            var row_no = new Date().getTime();\n            var newTr = $(\n                '<tr id=\"' + row_no + '\" class=\"' + item_id + '\" data-item-id=\"' + item_id + '\" data-id=\"' + item.row.id + '\"></tr>'\n            );\n            tr_html =\n                '<td><input name=\"product_id[]\" type=\"hidden\" class=\"rid\" value=\"' +\n                product_id +\n                '\"><input name=\"item_comment[]\" type=\"hidden\" class=\"ritem_comment\" value=\"' +\n                item_comment +\n                '\"><input name=\"product_code[]\" type=\"hidden\" value=\"' +\n                item.row.code +\n                '\"><input name=\"product_name[]\" type=\"hidden\" value=\"' +\n                item.row.name +\n                '\"><button type=\"button\" class=\"btn bg-purple btn-block btn-xs edit\" id=\"' +\n                row_no +\n                '\" data-item=\"' +\n                item_id +\n                '\"><span class=\"sname\" id=\"name_' +\n                row_no +\n                '\">' +\n                item_name +\n                ' (' +\n                item_code +\n                ')</span></button></td>';\n            // <input class=\"rprice\" name=\"net_price[]\" type=\"hidden\" id=\"price_' + row_no + '\" value=\"' + formatDecimal(item_price) + '\">\n            tr_html +=\n                '<td class=\"text-right\"><input class=\"realuprice\" name=\"real_unit_price[]\" type=\"hidden\" value=\"' +\n                item.row.real_unit_price +\n                '\"><input class=\"rdiscount\" name=\"product_discount[]\" type=\"hidden\" id=\"discount_' +\n                row_no +\n                '\" value=\"' +\n                ds +\n                '\"><span class=\"text-right sprice\" id=\"sprice_' +\n                row_no +\n                '\">' +\n                formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val)) +\n                '</span></td>';\n            tr_html +=\n                '<td><input name=\"item_was_ordered[]\" type=\"hidden\" class=\"riwo\" value=\"' +\n                item_was_ordered +\n                '\"><input class=\"form-control input-qty kb-pad text-center rquantity\" name=\"quantity[]\" type=\"text\" value=\"' +\n                formatDecimal(item_qty) +\n                '\" data-id=\"' +\n                row_no +\n                '\" data-item=\"' +\n                item_id +\n                '\" id=\"quantity_' +\n                row_no +\n                '\" onClick=\"this.select();\"></td>';\n            tr_html +=\n                '<td class=\"text-right\"><span class=\"text-right ssubtotal\" id=\"subtotal_' +\n                row_no +\n                '\">' +\n                formatMoney((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty)) +\n                '</span></td>';\n            tr_html += '<td class=\"text-center\"><i class=\"fa fa-trash-o tip pointer posdel\" id=\"' + row_no + '\" title=\"Remove\"></i></td>';\n            newTr.html(tr_html);\n            newTr.prependTo('#posTable');\n            total += formatDecimal((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty), 4);\n            count += parseFloat(item_qty);\n            an++;\n            // $('#list-table-div').scrollTop(0);\n            var oitb = $('#list-table-div')[0].scrollHeight;\n            $('#list-table-div').slimScroll({ scrollTo: oitb });\n            if (item_type == 'standard' && item_qty > item_aqty) {\n                $('#' + row_no).addClass('danger');\n                $('#' + row_no)\n                    .find('.edit')\n                    .removeClass('bg-purple')\n                    .addClass('btn-warning');\n            } else if (item_type == 'combo') {\n                if (combo_items === false) {\n                    $('#' + row_no).addClass('danger');\n                } else {\n                    $.each(combo_items, function() {\n                        if (parseFloat(this.quantity) < parseFloat(this.qty) * item_qty) {\n                            $('#' + row_no).addClass('danger');\n                            $('#' + row_no)\n                                .find('.edit')\n                                .removeClass('bg-purple')\n                                .addClass('btn-warning');\n                        }\n                    });\n                }\n            }\n\n            var comments = item_comment ? item_comment.split(/\\r?\\n/g) : [];\n            if (Settings.remote_printing != 1) {\n                b_items += '#' + (an - 1) + ' ' + item_name + ' (' + item_code + ')' + '\\n';\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    b_items += comments[i].length > 0 ? '   * ' + comments[i] + '\\n' : '';\n                }\n                b_items +=\n                    printLine(\n                        item_qty +\n                            ' x ' +\n                            formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val)) +\n                            ': ' +\n                            formatMoney((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty))\n                    ) + '\\n';\n                o_items +=\n                    printLine('#' + (an - 1) + ' ' + item_name + ' (' + item_code + '): [ ' + (item_was_ordered != 0 ? 'xxxx' : item_qty)) +\n                    ' ]\\n';\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    o_items += comments[i].length > 0 ? '   * ' + comments[i] + '\\n' : '';\n                }\n                o_items += '\\n';\n            } else {\n                var bprTr =\n                    '<tr class=\"row_' +\n                    item_id +\n                    '\" data-item-id=\"' +\n                    item_id +\n                    '\"><td colspan=\"2\">#' +\n                    (an - 1) +\n                    ' ' +\n                    (item_id == 0 ? item.row.name : item_name + ' (' + item_code + ')');\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    bprTr += comments[i] ? '<br> <b>*</b> <small>' + comments[i] + '</small>' : '';\n                }\n                bprTr += '</td></tr>';\n                bprTr +=\n                    '<tr class=\"bb row_' +\n                    item_id +\n                    '\" data-item-id=\"' +\n                    item_id +\n                    '\"><td>(' +\n                    item_qty +\n                    ' x ' +\n                    formatMoney(parseFloat(net_price) + parseFloat(pr_tax_val)) +\n                    ')</td><td style=\"text-align:right;\">' +\n                    formatMoney((parseFloat(net_price) + parseFloat(pr_tax_val)) * parseFloat(item_qty)) +\n                    '</td></tr>';\n                var oprTr =\n                    '<tr class=\"bb row_' +\n                    item_id +\n                    '\" data-item-id=\"' +\n                    item_id +\n                    '\"><td>#' +\n                    (an - 1) +\n                    ' ' +\n                    item_name +\n                    ' (' +\n                    item_code +\n                    ')';\n                for (var i = 0, len = comments.length; i < len; i++) {\n                    oprTr += comments[i] ? '<br> <b>*</b> <small>' + comments[i] + '</small>' : '';\n                }\n                oprTr += '</td><td>[ ' + (item_was_ordered != 0 ? 'xxxx' : item_qty) + ' ]</td></tr>';\n                $('#order-table').append(oprTr);\n                $('#bill-table').append(bprTr);\n            }\n        });\n\n        var ds = get('spos_discount') ? get('spos_discount') : $('#discount_val').val() ? $('#discount_val').val() : '0';\n        order_discount = parseFloat(ds);\n        if (ds.indexOf('%') !== -1) {\n            var pds = ds.split('%');\n            order_discount = parseFloat((total * parseFloat(pds[0])) / 100);\n        }\n\n        var ts = get('spos_tax') ? get('spos_tax') : $('#tax_val').val() ? $('#tax_val').val() : '0';\n        order_tax = parseFloat(ts);\n        if (ts.indexOf('%') !== -1) {\n            var pts = ts.split('%');\n            order_tax = ((total - order_discount) * parseFloat(pts[0])) / 100;\n        }\n\n        var g_total = total - parseFloat(order_discount) + parseFloat(order_tax);\n        grand_total = formatMoney(g_total);\n        $('#ds_con').text('(' + formatMoney(product_discount) + ') ' + formatMoney(order_discount));\n        $('#ts_con').text(formatMoney(order_tax));\n        $('#total-payable').text(grand_total);\n        $('#total').text(formatMoney(total));\n        $('#count').text(an - 1 + ' (' + formatMoney(count - 1) + ')');\n\n        if (Settings.remote_printing != 1) {\n            order_data.items = o_items;\n            bill_data.items = b_items;\n            var b_totals = '';\n            b_totals += printLine(lang.total + ': ' + formatMoney(total)) + '\\n';\n            if (order_discount > 0 || product_discount > 0) {\n                b_totals += printLine(lang.discount + ': ' + formatMoney(order_discount + product_discount)) + '\\n';\n            }\n            if (order_tax != 0) {\n                b_totals += printLine(lang.order_tax + ': ' + formatMoney(order_tax)) + '\\n';\n            }\n            b_totals += printLine(lang.grand_total + ': ' + formatMoney(g_total)) + '\\n';\n            if (Settings.rounding != 0) {\n                round_total = roundNumber(g_total, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - g_total, 4);\n                b_totals += printLine(lang.rounding + ': ' + formatMoney(rounding)) + '\\n';\n                b_totals += printLine(lang.total_payable + ': ' + formatMoney(round_total)) + '\\n';\n            }\n            b_totals += '\\n' + lang.total_items + ': ' + (an - 1) + ' (' + (parseFloat(count) - 1) + ')' + '\\n';\n            bill_data.totals = b_totals;\n        } else {\n            var bill_totals = '';\n            bill_totals +=\n                '<tr class=\"bb\"><td>' +\n                lang.total_items +\n                '</td><td style=\"text-align:right;\">' +\n                (an - 1) +\n                ' (' +\n                (parseFloat(count) - 1) +\n                ')</td></tr>';\n            bill_totals += '<tr class=\"bb\"><td>' + lang.total + '</td><td style=\"text-align:right;\">' + formatMoney(total) + '</td></tr>';\n            if (order_discount > 0 || product_discount > 0) {\n                bill_totals +=\n                    '<tr class=\"bb\"><td>' +\n                    lang.discount +\n                    '</td><td style=\"text-align:right;\">' +\n                    formatMoney(order_discount + product_discount) +\n                    '</td></tr>';\n            }\n            if (order_tax != 0) {\n                bill_totals +=\n                    '<tr class=\"bb\"><td>' + lang.order_tax + '</td><td style=\"text-align:right;\">' + formatMoney(order_tax) + '</td></tr>';\n            }\n            bill_totals +=\n                '<tr class=\"bb\"><td>' + lang.grand_total + '</td><td style=\"text-align:right;\">' + formatMoney(g_total) + '</td></tr>';\n            if (Settings.rounding != 0) {\n                round_total = roundNumber(g_total, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - g_total, 4);\n                bill_totals +=\n                    '<tr class=\"bb\"><td>' + lang.rounding + '</td><td style=\"text-align:right;\">' + formatMoney(rounding) + '</td></tr>';\n                bill_totals +=\n                    '<tr class=\"bb\"><td>' +\n                    lang.total_payable +\n                    '</td><td style=\"text-align:right;\">' +\n                    formatMoney(round_total) +\n                    '</td></tr>';\n            }\n            bill_totals += '<tr class=\"bb\"><td colspan=\"2\" style=\"text-align:center;\">' + lang.merchant_copy + '</td></tr>';\n            $('#bill-total-table').empty();\n            $('#bill-total-table').append(bill_totals);\n        }\n\n        if (Settings.display_kb == 1) {\n            display_keyboards();\n        }\n        $('#add_item').focus();\n    }\n}\n\nfunction chr(i) {\n    return String.fromCharCode(i);\n}\n\n$(document).ready(function() {\n    $(document).on('click', '.no-results, #filter-suspended-sales', function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    $('#susModal').on('shown.bs.modal', function(e) {\n        $('#reference_note').focus();\n    });\n\n    $('#filter-categories').hideseek({\n        nodata: lang.no_match_found,\n    });\n\n    $(document).on('click', '.suspended_sales .dropdown-menu .header', function(e) {\n        e.stopPropagation();\n    });\n\n    $('#filter-suspended-sales').hideseek({\n        nodata: lang.no_match_found,\n    });\n\n    $('#suspended_sales').on('shown.bs.dropdown', function() {\n        $('#filter-suspended-sales').focus();\n    });\n\n    $(document).on('click', '#update-note', function() {\n        var n = $('#snote').val();\n        store('spos_note', n);\n        $('#note').val(n);\n        $('#noteModal').modal('hide');\n    });\n    /* =============================\n    Edit Item Modal\n    ============================= */\n\n    $('#posTable').on('click', '.edit', function() {\n        var row = $(this).closest('tr');\n        var id = row.attr('id');\n        var item_id = row.attr('data-item-id');\n        var item_rid = row.attr('data-id');\n        var item = spositems[item_id];\n        //var unit_price = parseFloat(item.row.real_unit_price);\n        var unit_price = formatDecimal(row.find('.realuprice').val());\n        var net_price = unit_price;\n        var ds = item.row.discount ? item.row.discount : '0';\n        item_discount = formatDecimal(parseFloat(ds));\n        if (ds.indexOf('%') !== -1) {\n            var pds = ds.split('%');\n            if (!isNaN(pds[0])) {\n                item_discount = formatDecimal((net_price * parseFloat(pds[0])) / 100);\n            }\n        }\n        net_price -= item_discount;\n        var pr_tax = parseFloat(item.row.tax),\n            pr_tax_val = 0,\n            tax = '';\n        if (pr_tax !== null && pr_tax != 0) {\n            if (parseFloat(item.row.tax_method) == 0) {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100 + parseFloat(pr_tax)));\n                net_price -= pr_tax_val;\n                tax = lang.inclusive;\n            } else {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                tax = lang.exclusive;\n            }\n        }\n        console.log(item_rid, item_id, id);\n        $('#proModalLabel').html('<a href=\"' + base_url + '/products/view/' + item_rid + '\" data-toggle=\"ajax\">' + item.label + '</a>');\n        $('#net_price').text(formatMoney(net_price));\n        $('#pro_tax').text(formatMoney(pr_tax_val));\n        $('#pro_tax_method').text('(' + tax + ')');\n        $('#row_id').val(row_id);\n        $('#item_id').val(item_id);\n        $('#nPrice').val(unit_price);\n        $('#nQuantity').val(item.row.qty);\n        $('#nDiscount').val(ds);\n        $('#nComment').val(item.row.comment);\n        $('#proModal').modal({ backdrop: 'static' });\n    });\n\n    $(document).on('change', '#nPrice, #nDiscount', function() {\n        var item_id = $('#item_id').val();\n        var unit_price = parseFloat($('#nPrice').val());\n        var net_price = unit_price;\n        var item = spositems[item_id];\n        var ds = $('#nDiscount').val() ? $('#nDiscount').val() : '0';\n        item_discount = formatDecimal(parseFloat(ds));\n        if (ds.indexOf('%') !== -1) {\n            var pds = ds.split('%');\n            if (!isNaN(pds[0])) {\n                item_discount = formatDecimal((unit_price * parseFloat(pds[0])) / 100);\n            }\n        }\n        net_price -= item_discount;\n        var pr_tax = parseFloat(item.row.tax),\n            pr_tax_val = 0;\n        if (pr_tax !== null && pr_tax != 0) {\n            if (parseFloat(item.row.tax_method) == 0) {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / (100 + parseFloat(pr_tax)));\n                net_price -= pr_tax_val;\n                tax = lang.inclusive;\n            } else {\n                pr_tax_val = formatDecimal((net_price * parseFloat(pr_tax)) / 100);\n                tax = lang.exclusive;\n            }\n        }\n\n        $('#net_price').text(formatMoney(net_price));\n        $('#pro_tax').text(formatMoney(pr_tax_val));\n    });\n\n    /* =============================\n    Edit Item Method\n    ============================= */\n    $(document).on('click', '#editItem', function() {\n        var item_id = $('#item_id').val();\n        var price = parseFloat($('#nPrice').val());\n        if (!is_valid_discount($('#nDiscount').val())) {\n            bootbox.alert(lang.unexpected_value);\n            return false;\n        }\n        (spositems[item_id].row.qty = parseFloat($('#nQuantity').val())),\n            (spositems[item_id].row.real_unit_price = price),\n            (spositems[item_id].row.comment = $('#nComment').val()),\n            (spositems[item_id].row.discount = $('#nDiscount').val() ? $('#nDiscount').val() : '0'),\n            localStorage.setItem('spositems', JSON.stringify(spositems));\n        $('#proModal').modal('hide');\n\n        loadItems();\n        return;\n    });\n\n    /* =============================\n    Row quantity change\n    ============================= */\n    $(document).on('change', '.rquantity', function() {\n        var row = $(this).closest('tr');\n        if (!is_numeric($(this).val()) || $(this).val() == 0) {\n            loadItems();\n            bootbox.alert(lang.unexpected_value);\n            return false;\n        }\n        var new_qty = parseFloat($(this).val()),\n            item_id = row.attr('data-item-id');\n        spositems[item_id].row.qty = new_qty;\n        localStorage.setItem('spositems', JSON.stringify(spositems));\n        loadItems();\n    });\n\n    $('#reset').click(function(e) {\n        if (count <= 1) {\n            return false;\n        }\n        if (protect_delete == 1) {\n            var boxd = bootbox.dialog({\n                title: lang.enter_pin_code,\n                closeButton: true,\n                message: '<input id=\"pos_pin\" name=\"pos_pin\" type=\"password\" placeholder=\"Pin Code\" class=\"form-control kb-pad\"> ',\n                buttons: {\n                    danger: {\n                        label: lang.close,\n                        className: 'btn-default pull-left',\n                        callback: function() {},\n                    },\n                    success: {\n                        label: \"<i class='fa fa-tick'></i> \" + lang.delete,\n                        className: 'btn-warning verify_pin',\n                        callback: function() {\n                            var pos_pin = md5($('#pos_pin').val());\n                            if (pos_pin == Settings.pin_code) {\n                                if (get('spositems')) {\n                                    remove('spositems');\n                                }\n                                if (get('spos_tax')) {\n                                    remove('spos_tax');\n                                }\n                                if (get('spos_discount')) {\n                                    remove('spos_discount');\n                                }\n                                if (get('spos_customer')) {\n                                    remove('spos_customer');\n                                }\n                                window.location.href = base_url + 'pos';\n                            } else {\n                                bootbox.alert(lang.wrong_pin);\n                            }\n                        },\n                    },\n                },\n            });\n            boxd.on('shown.bs.modal', function() {\n                if (Settings.display_kb == 1) {\n                    display_keyboards();\n                }\n                $('#pos_pin')\n                    .focus()\n                    .keypress(function(e) {\n                        if (e.keyCode == 13) {\n                            e.preventDefault();\n                            $('.verify_pin').trigger('click');\n                            return false;\n                        }\n                    });\n            });\n        } else {\n            bootbox.confirm(lang.r_u_sure, function(result) {\n                if (result) {\n                    if (get('spositems')) {\n                        remove('spositems');\n                    }\n                    if (get('spos_tax')) {\n                        remove('spos_tax');\n                    }\n                    if (get('spos_discount')) {\n                        remove('spos_discount');\n                    }\n                    if (get('spos_customer')) {\n                        remove('spos_customer');\n                    }\n                    window.location.href = base_url + 'pos';\n                }\n            });\n        }\n    });\n\n    $('#print_order').click(function(e) {\n        e.preventDefault();\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n        } else {\n            if (Settings.remote_printing == 0) {\n                $('#order-data').show();\n                if (Settings.print_img == 1) {\n                    $('#preo').html(\n                        '<pre style=\"background:#FFF;font-size:20px;margin:0;border:0;color:#000 !important;\">' + order_data.info + order_data.items + '</pre>'\n                    );\n                    var element = $('#order-data').get(0);\n                    html2canvas(element, {scrollY: 0, scale: 1.7}).then(function(canvas) {\n                        var img = canvas.toDataURL().split(',')[1];\n                        $.post(base_url + 'pos/receipt_img', { img: img, spos_token: csrf_hash });\n                        // return Canvas2Image.saveAsPNG(canvas);\n                    });\n                } else {\n                    var form = $('#pos-sale-form').serialize();\n                    $.post(base_url + 'pos/p/order', form);\n                }\n            } else {\n                printOrder(order_data);\n            }\n        }\n        setTimeout(function() {\n            $('#order-data').hide();\n        }, 500);\n        return false;\n    });\n\n    $('#print_bill').click(function(e) {\n        e.preventDefault();\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n        } else {\n            if (Settings.remote_printing == 0) {\n                $('#bill-data').show();\n                if (Settings.print_img == 1) {\n                    $('#preb').html(\n                        '<pre style=\"background:#FFF;font-size:20px;margin:0;border:0;color:#000 !important;\">' +\n                            bill_data.info +\n                            bill_data.items +\n                            '\\n' +\n                            bill_data.totals +\n                            '</pre>'\n                    );\n                var element = $('#bill-data').get(0);\n                html2canvas(element, {scrollY: 0, scale: 1.7}).then(function(canvas) {\n                    var img = canvas.toDataURL().split(',')[1];\n                    $.post(base_url + 'pos/receipt_img', { img: img, spos_token: csrf_hash });\n                    // return Canvas2Image.saveAsPNG(canvas);\n                });\n                } else {\n                    var form = $('#pos-sale-form').serialize();\n                    $.post(base_url + 'pos/p/bill', form);\n                }\n            } else {\n                printBill(bill_data);\n            }\n        }\n        setTimeout(function() {\n            $('#bill-data').hide();\n        }, 500);\n        return false;\n    });\n\n    $('#updateDiscount').click(function() {\n        var ds = $('#get_ds').val() ? $('#get_ds').val() : '0';\n        var apply_to = $('input[name=apply_to]:checked').val();\n        if (ds.length != 0) {\n            if (apply_to == 'order') {\n                $('#discount_val').val(ds);\n                store('spos_discount', ds);\n                if (ds.indexOf('%') !== -1) {\n                    var pds = ds.split('%');\n\n                    order_discount = (total * parseFloat(pds[0])) / 100;\n                    order_tax = calTax();\n                    var g_total = total + order_tax - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ds_con').text('(' + formatMoney(product_discount) + ') ' + formatMoney(order_discount));\n                    $('#total-payable').text(formatMoney(grand_total));\n                } else {\n                    order_discount = ds;\n                    order_tax = calTax();\n                    var g_total = total + order_tax - parseFloat(order_discount);\n                    grand_total = parseFloat(g_total);\n                    $('#ds_con').text('(' + formatMoney(product_discount) + ') ' + formatMoney(order_discount));\n                    $('#total-payable').text(formatMoney(grand_total));\n                }\n            } else if (apply_to == 'products') {\n                var items = {};\n                spositems = JSON.parse(get('spositems'));\n                $.each(spositems, function() {\n                    this.row.discount = ds;\n                });\n                store('spositems', JSON.stringify(spositems));\n            }\n            loadItems();\n            $('#dsModal').modal('hide');\n        }\n    });\n\n    $('#add_discount').click(function() {\n        var dval = $('#discount_val').val();\n        $('#get_ds').val(dval);\n        $('#dsModal').modal({ backdrop: 'static' });\n        return false;\n    });\n    $('#dsModal').on('shown.bs.modal', function() {\n        $('#get_ds').focusToEnd();\n    });\n\n    $('#updateTax').click(function() {\n        var ts = $('#get_ts').val();\n        if (ts.length != 0) {\n            $('#tax_val').val(ts);\n            store('spos_tax', ts);\n            if (ts.indexOf('%') !== -1) {\n                var pts = ts.split('%');\n                if (!isNaN(pts[0])) {\n                    order_tax = ((total - order_discount) * parseFloat(pts[0])) / 100;\n                    var g_total = total + order_tax - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ts_con').text(formatMoney(order_tax));\n                    $('#total-payable').text(formatMoney(grand_total));\n                } else {\n                    $('#get_ts').val('0');\n                    $('#tax_val').val('0');\n                    var g_total = total - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ts_con').text('0');\n                    $('#total-payable').text(formatMoney(grand_total));\n                }\n            } else {\n                if (!isNaN(ts) && ts != 0) {\n                    order_tax = ts;\n                    var g_total = total + parseFloat(ts) - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ts_con').text(formatMoney(order_tax));\n                    $('#total-payable').text(formatMoney(grand_total));\n                } else {\n                    $('#get_ts').val('0');\n                    $('#tax_val').val('0');\n                    var g_total = total - order_discount;\n                    grand_total = parseFloat(g_total);\n                    $('#ts_con').text('0');\n                    $('#total-payable').text(formatMoney(grand_total));\n                }\n            }\n            $('#tsModal').modal('hide');\n        }\n    });\n\n    $('#add_tax').click(function() {\n        var tval = $('#tax_val').val();\n        $('#get_ts').val(tval);\n        $('#tsModal').modal({ backdrop: 'static' });\n        return false;\n    });\n    $('#tsModal').on('shown.bs.modal', function() {\n        $('#get_ts').focusToEnd();\n    });\n    $('#noteModal').on('shown.bs.modal', function() {\n        $('#snote').focusToEnd();\n    });\n\n    $(document).on('click', '.product', function(e) {\n        code = $(this).val();\n        $.ajax({\n            type: 'get',\n            url: base_url + 'pos/get_product/' + code,\n            dataType: 'json',\n            success: function(data) {\n                if (data !== null) {\n                    add_invoice_item(data);\n                } else {\n                    bootbox.alert(lang.no_match_found);\n                }\n            },\n        });\n    });\n\n    $(document).on('click', '.category', function() {\n        var cid = $(this).attr('id');\n        if (cat_id != cid) {\n            cat_id = cid;\n            $.ajax({\n                type: 'get',\n                url: base_url + 'pos/ajaxproducts',\n                data: { category_id: cat_id, tcp: 1 },\n                dataType: 'json',\n                success: function(data) {\n                    p_page = 'n';\n                    // $('#categories-list').addClass('control-sidebar-open');\n                    //ocat_id = cat_id;\n                    tcp = data.tcp;\n                    $('.items').html(data.products);\n                    $('.category').removeClass('active');\n                    $('#' + cat_id).addClass('active');\n                    nav_pointer();\n                },\n            });\n        }\n        return false;\n    });\n    $('#category-' + cat_id).addClass('active');\n\n    $('#next').click(function() {\n        if (p_page == 'n') {\n            p_page = 0;\n        }\n        p_page += pro_limit;\n        if (tcp >= pro_limit && p_page < tcp) {\n            $.ajax({\n                type: 'get',\n                url: base_url + 'pos/ajaxproducts',\n                data: { category_id: cat_id, per_page: p_page },\n                dataType: 'html',\n                success: function(data) {\n                    $('.items').html(data);\n                    nav_pointer();\n                },\n            });\n        } else {\n            p_page -= pro_limit;\n        }\n    });\n\n    $('#previous').click(function() {\n        if (p_page == 'n') {\n            p_page = 0;\n        }\n        if (p_page != 0) {\n            p_page -= pro_limit;\n            if (p_page == 0) {\n                p_page = 'n';\n            }\n            $.ajax({\n                type: 'get',\n                url: base_url + 'pos/ajaxproducts',\n                data: { category_id: cat_id, per_page: p_page },\n                dataType: 'html',\n                success: function(data) {\n                    $('.items').html(data);\n                    nav_pointer();\n                },\n            });\n        }\n    });\n\n    $('#add_item').autocomplete({\n        source: base_url + 'pos/suggestions',\n        minLength: 1,\n        autoFocus: false,\n        delay: 200,\n        response: function(event, ui) {\n            if ($(this).val().length >= 16 && ui.content[0].id == 0) {\n                bootbox.alert(lang.no_match_found, function() {\n                    $('#add_item').focus();\n                });\n                $(this).val('');\n            } else if (ui.content.length == 1 && ui.content[0].id != 0) {\n                ui.item = ui.content[0];\n                $(this)\n                    .data('ui-autocomplete')\n                    ._trigger('select', 'autocompleteselect', ui);\n                $(this).autocomplete('close');\n            } else if (ui.content.length == 1 && ui.content[0].id == 0) {\n                bootbox.alert(lang.no_match_found, function() {\n                    $('#add_item').focus();\n                });\n                $(this).val('');\n            }\n        },\n        select: function(event, ui) {\n            event.preventDefault();\n            if (ui.item.id !== 0) {\n                var row = add_invoice_item(ui.item);\n                if (row) $(this).val('');\n            } else {\n                bootbox.alert(lang.no_match_found);\n            }\n        },\n    });\n\n    $('#add_item').bind('keypress', function(e) {\n        if (e.keyCode == 13) {\n            e.preventDefault();\n            $(this).autocomplete('search');\n        }\n    });\n\n    $('#add_item').focus();\n    $('#gccard_no').inputmask('9999 9999 9999 9999');\n    $('#gift_card_no').inputmask('9999 9999 9999 9999');\n    $('#gcexpiry').inputmask('yyyy-mm-dd', { placeholder: 'yyyy-mm-dd' });\n    $('#genNo').click(function() {\n        var no = generateCardNo();\n        $(this)\n            .parent()\n            .parent('.input-group')\n            .children('input')\n            .val(no);\n        return false;\n    });\n\n    $(document).on('click', '#sellGiftCard', function(e) {\n        if (count == 1) {\n            spositems = {};\n        }\n        $('#gcModal').modal({ backdrop: 'static' });\n    });\n\n    $(document).on('click', '#addGiftCard', function(e) {\n        var mid = 0,\n            gccode = $('#gccard_no').val(),\n            gcname = $('#gcname').val(),\n            gcvalue = $('#gcvalue').val(),\n            gcprice = parseFloat($('#gcprice').val());\n        gcexpiry = $('#gcexpiry').val();\n        if (gccode == '' || gcvalue == '' || gcprice == '' || gcvalue == 0 || gcprice == 0) {\n            $('#gcerror').text(lang.file_required_fields);\n            $('.gcerror-con').show();\n            return false;\n        }\n        var gc_data = new Array();\n        gc_data[0] = gccode;\n        gc_data[1] = gcvalue;\n        gc_data[2] = gcexpiry;\n\n        $.ajax({\n            type: 'get',\n            url: base_url + 'gift_cards/sell_gift_card',\n            dataType: 'json',\n            data: { gcdata: gc_data },\n            success: function(data) {\n                if (data.result === 'success') {\n                    spositems[mid] = {\n                        id: mid,\n                        item_id: mid,\n                        label: gcname + ' (' + gccode + ')',\n                        row: {\n                            id: mid,\n                            code: gccode,\n                            name: gcname,\n                            quantity: 1,\n                            price: gcprice,\n                            real_unit_price: gcprice,\n                            tax: 0,\n                            qty: 1,\n                            type: 'manual',\n                            discount: '0',\n                            comment: '',\n                        },\n                    };\n                    store('spositems', JSON.stringify(spositems));\n                    loadItems();\n                    $('#gcModal').modal('hide');\n                    $('#gccard_no').val('');\n                    $('#gcvalue').val('');\n                    $('#gcprice').val('');\n                } else {\n                    $('#gcerror').text(data.message);\n                    $('.gcerror-con').show();\n                }\n            },\n        });\n    });\n\n    // $('#opModal').bind().on('click', 'a', function(){\n    //     var pg = $.url($(this).attr(\"href\")).param(\"per_page\");\n    //     $.get( base_url+'pos/ob_page&per_page='+pg, function( data ) {\n    //         $( \".html_con\" ).html( data.pd );\n    //         $( \".page_con\" ).html( data.page );\n    //     }, \"json\");\n\n    //     return false;\n    // });\n\n    var pwacc = false;\n    $(document).on('click', '.posdel', function() {\n        var row = $(this).closest('tr');\n        var item_id = row.attr('data-item-id');\n        if (protect_delete == 1) {\n            var boxd = bootbox.dialog({\n                title: lang.enter_pin_code,\n                closeButton: true,\n                message: '<input id=\"pos_pin\" name=\"pos_pin\" type=\"password\" placeholder=\"Pin Code\" class=\"form-control kb-pad\"> ',\n                buttons: {\n                    danger: {\n                        label: lang.close,\n                        className: 'btn-default pull-left',\n                        callback: function() {},\n                    },\n                    success: {\n                        label: \"<i class='fa fa-tick'></i> \" + lang.delete,\n                        className: 'btn-warning verify_pin',\n                        callback: function() {\n                            var pos_pin = md5($('#pos_pin').val());\n                            if (pos_pin == Settings.pin_code) {\n                                delete spositems[item_id];\n                                row.remove();\n                                if (spositems.hasOwnProperty(item_id)) {\n                                } else {\n                                    localStorage.setItem('spositems', JSON.stringify(spositems));\n                                    loadItems();\n                                }\n                            } else {\n                                bootbox.alert(lang.wrong_pin);\n                            }\n                        },\n                    },\n                },\n            });\n            boxd.on('shown.bs.modal', function() {\n                if (Settings.display_kb == 1) {\n                    display_keyboards();\n                }\n                $('#pos_pin')\n                    .focus()\n                    .keypress(function(e) {\n                        if (e.keyCode == 13) {\n                            e.preventDefault();\n                            $('.verify_pin').trigger('click');\n                            return false;\n                        }\n                    });\n            });\n        } else {\n            delete spositems[item_id];\n            row.remove();\n            if (spositems.hasOwnProperty(item_id)) {\n            } else {\n                localStorage.setItem('spositems', JSON.stringify(spositems));\n                loadItems();\n            }\n        }\n        return false;\n    });\n\n    $('#suspend').click(function() {\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n            return false;\n        } else {\n            $('#susModal').modal({ backdrop: 'static' });\n        }\n    });\n\n    $('#suspend_sale').click(function() {\n        ref = $('#reference_note').val();\n        if (!ref || ref == '') {\n            bootbox.alert(lang.type_reference_note);\n            return false;\n        } else {\n            suspend = $('<span></span>');\n            if (sid !== 0) {\n                suspend.html(\n                    '<input type=\"hidden\" name=\"delete_id\" value=\"' +\n                        sid +\n                        '\" /><input type=\"hidden\" name=\"suspend\" value=\"yes\" /><input type=\"hidden\" name=\"suspend_note\" value=\"' +\n                        ref +\n                        '\" />'\n                );\n            } else {\n                suspend.html(\n                    '<input type=\"hidden\" name=\"suspend\" value=\"yes\" /><input type=\"hidden\" name=\"suspend_note\" value=\"' + ref + '\" />'\n                );\n            }\n            suspend.appendTo('#hidesuspend');\n            $('#pos-sale-form').submit();\n        }\n    });\n\n    $('#payment').click(function() {\n        if (count <= 1) {\n            bootbox.alert(lang.please_add_product);\n            return false;\n        } else {\n            if (sid) {\n                suspend = $('<span></span>');\n                suspend.html('<input type=\"hidden\" name=\"delete_id\" value=\"' + sid + '\" />');\n                suspend.appendTo('#hidesuspend');\n            }\n\n            gtotal = formatDecimal(total - order_discount + order_tax);\n            if (Settings.rounding != 0) {\n                round_total = roundNumber(gtotal, parseInt(Settings.rounding));\n                var rounding = formatDecimal(round_total - gtotal);\n                $('#twt').text(formatMoney(round_total) + ' (' + formatMoney(rounding) + ')');\n                $('#quick-payable').text(round_total);\n            } else {\n                $('#twt').text(formatMoney(gtotal));\n                $('#quick-payable').text(gtotal);\n            }\n            $('#item_count').text(an - 1 + ' (' + (count - 1) + ')');\n            $('#order_quantity').val(count - 1);\n            $('#order_items').val(an - 1);\n            $('#balance').text('0.00');\n            $('#payModal').modal({ backdrop: 'static' });\n        }\n    });\n    $('#payModal').on('shown.bs.modal', function(e) {\n        $('#amount')\n            .focus()\n            .val(0);\n        $('#quick-payable').click();\n    });\n    $('#payModal').on('hidden.bs.modal', function(e) {\n        $('#amount')\n            .val('')\n            .change();\n    });\n\n    $('#amount').change(function(e) {\n        var total_paying = $('.amount').val();\n        $('#total_paying').text(formatMoney(total_paying));\n        if (Settings.rounding != 0) {\n            $('#balance').text(formatMoney(total_paying - round_total));\n            $('#balance_val').val(formatDecimal(total_paying - round_total));\n            total_paid = total_paying;\n            grand_total = round_total;\n        } else {\n            $('#balance').text(formatMoney(total_paying - gtotal));\n            $('#balance_val').val(formatDecimal(total_paying - gtotal));\n            total_paid = total_paying;\n            grand_total = gtotal;\n        }\n    });\n\n    $('#add-customer').click(function() {\n        $('#customerModal').modal({ backdrop: 'static' });\n    });\n\n    $('#payModal').on('change', '#paid_by', function() {\n        $('#clear-cash-notes').click();\n        $('#amount').val(grand_total);\n        var p_val = $(this).val();\n        $('#paid_by_val').val(p_val);\n        var gtotal = formatDecimal(total - order_discount + order_tax);\n        if (Settings.rounding != 0) {\n            var rounded_total = formatDecimal(roundNumber(gtotal, parseInt(Settings.rounding)));\n        } else {\n            var rounded_total = formatDecimal(gtotal);\n        }\n        $('#rpaidby').val(p_val);\n        if (p_val == 'gift_card') {\n            $('.gc').slideDown();\n            $('.ngc').slideUp('fast');\n            setTimeout(function() {\n                $('#gift_card_no').focus();\n            }, 10);\n            $('#amount').attr('readonly', true);\n        } else {\n            $('.ngc').slideDown();\n            $('.gc').slideUp('fast');\n            $('#gc_details').html('');\n            $('#amount').attr('readonly', false);\n        }\n        if (p_val == 'cash' || p_val == 'other') {\n            $('.pcash').slideDown();\n            $('.pcheque').slideUp('fast');\n            $('.pcc').slideUp('fast');\n            setTimeout(function() {\n                $('#amount').focus();\n            }, 10);\n        } else if (p_val == 'CC' || p_val == 'stripe') {\n            $('.pcc').slideDown();\n            $('.pcheque').slideUp('fast');\n            $('.pcash').slideUp('fast');\n            $('#amount').val(rounded_total);\n            setTimeout(function() {\n                $('#swipe')\n                    .val('')\n                    .focus();\n            }, 10);\n        } else if (p_val == 'cheque') {\n            $('.pcheque').slideDown();\n            $('.pcc').slideUp('fast');\n            $('.pcash').slideUp('fast');\n            $('#amount').val(rounded_total);\n            setTimeout(function() {\n                $('#cheque_no').focus();\n            }, 10);\n        } else {\n            $('.pcheque').hide();\n            $('.pcc').hide();\n            $('.pcash').hide();\n        }\n    });\n\n    $(document).on('change', '.gift_card_no', function() {\n        var cn = $(this).val() ? $(this).val() : '';\n        if (cn != '') {\n            $.ajax({\n                type: 'get',\n                async: false,\n                url: base_url + 'pos/validate_gift_card/' + cn,\n                dataType: 'json',\n                success: function(data) {\n                    if (data === false || data.balance < 0) {\n                        $('#gift_card_no')\n                            .parent('.form-group')\n                            .addClass('has-error');\n                        bootbox.alert(lang.incorrect_gift_card);\n                    } else {\n                        $('#gc_details').html(\n                            lang.card_no +\n                                ': ' +\n                                data.card_no +\n                                '<br>' +\n                                lang.value +\n                                ': ' +\n                                data.value +\n                                ' - ' +\n                                lang.balance +\n                                ': ' +\n                                data.balance\n                        );\n                        $('#gift_card_no')\n                            .parent('.form-group')\n                            .removeClass('has-error');\n                        var paying = gtotal > data.balance ? data.balance : gtotal;\n                        $('#amount_val').val(paying);\n                        $('#amount').val(paying);\n                    }\n                },\n            });\n        }\n        return false;\n    });\n\n    $(document).on('click', '#quick-payable', function() {\n        $('#clear-cash-notes').click();\n        $(this).append('<span class=\"badge\">1</span>');\n        $('#amount').val(grand_total);\n    });\n\n    $(document).on('click', '.quick-cash', function() {\n        if ($('#quick-payable').find('span.badge').length) {\n            $('#clear-cash-notes').click();\n        }\n        var $quick_cash = $(this);\n        var amt = $quick_cash\n            .contents()\n            .filter(function() {\n                return this.nodeType == 3;\n            })\n            .text();\n        var th = Settings.thousands_sep == 0 ? '' : Settings.thousands_sep;\n        var $pi = $('#amount');\n        amt = formatDecimal(amt.split(th).join('')) * 1 + $pi.val() * 1;\n        $pi.val(formatDecimal(amt))\n            .change()\n            .focus();\n        var note_count = $quick_cash.find('span');\n        if (note_count.length == 0) {\n            $quick_cash.append('<span class=\"badge\">1</span>');\n        } else {\n            note_count.text(parseInt(note_count.text()) + 1);\n        }\n    });\n\n    $(document).on('click', '#clear-cash-notes', function() {\n        $('.quick-cash')\n            .find('.badge')\n            .remove();\n        $('#amount')\n            .val('')\n            .change()\n            .focus();\n    });\n\n    $('#payModal').on('change', '#amount, #paid_by', function(e) {\n        $('#amount_val').val($('#amount').val());\n    });\n    $('#payModal').on('blur', '#amount', function(e) {\n        $('#amount_val').val($('#amount').val());\n    });\n    $('#payModal').on('select2-close', '#paid_by', function(e) {\n        $('#paid_by_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_no', function(e) {\n        $('#cc_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_holder', function(e) {\n        $('#cc_holder_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#gift_card_no', function(e) {\n        $('#paying_gift_card_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_month', function(e) {\n        $('#cc_month_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_year', function(e) {\n        $('#cc_year_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_type', function(e) {\n        $('#cc_type_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#pcc_cvv2', function(e) {\n        $('#cc_cvv2_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#cheque_no', function(e) {\n        $('#cheque_no_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#payment_note', function(e) {\n        $('#payment_note_val').val($(this).val());\n    });\n    $('#payModal').on('change', '#note', function(e) {\n        var n = $(this).val();\n        store('spos_note', n);\n        $('#spos_note').val(n);\n    });\n    if ((spos_note = get('spos_note'))) {\n        $('#note').val(spos_note);\n        $('#snote').val(spos_note);\n    }\n    $('#spos_customer').change(function(e) {\n        store('spos_customer', $(this).val());\n    });\n    if ((spos_customer = get('spos_customer'))) {\n        $('#spos_customer').select2('val', spos_customer);\n    }\n\n    $('.treeview').hover(function(e) {\n        var wh = $(document).height();\n        var top = $(this).offset().top;\n        var menu = $(this).find('.treeview-menu');\n        var menuh = menu.height() + 44;\n        if (wh - top < menuh) {\n            $(this)\n                .find('a')\n                .children('span')\n                .addClass('popup');\n            menu.addClass('popup');\n        } else {\n            $(this)\n                .find('a')\n                .children('span')\n                .removeClass('popup');\n            menu.removeClass('popup');\n        }\n    });\n\n    $('body').click(function(e) {\n        if (\n            !$(e.target).hasClass('sidebar-icon') &&\n            !$(e.target).hasClass('sb') &&\n            $('#categories-list').hasClass('control-sidebar-open')\n        ) {\n            $('#categories-list').removeClass('control-sidebar-open');\n        }\n    });\n\n    $('#submit-sale').click(function() {\n        $('#total_items').val(an - 1);\n        $('#total_quantity').val(count - 1);\n        // console.log($('#amount_val').val());\n        $('#submit').click();\n    });\n\n    var hold_ref = $('#hold_ref').val();\n    $('#hold_ref').change(function() {\n        hold_ref = $(this).val();\n        $('#reference_note').val(hold_ref);\n    });\n    $('#reference_note').change(function() {\n        hold_ref = $(this).val();\n        $('#hold_ref').val(hold_ref);\n    });\n\n    $('#suspend_sale').click(function() {\n        if ($('#reference_note').val()) {\n            $('#hold_ref').val($('#reference_note').val());\n            $('#total_items').val(an - 1);\n            $('#total_quantity').val(count - 1);\n            $('#submit').click();\n        }\n        return false;\n    });\n\n    $('#customer-form').on('submit', function(e) {\n        e.preventDefault();\n        $.ajax({\n            type: 'post',\n            url: base_url + 'customers/add',\n            data: $(this).serialize(),\n            dataType: 'json',\n            success: function(res) {\n                if (res.status == 'success') {\n                    $('#spos_customer').append(\n                        $('<option></option>')\n                            .attr('value', res.id)\n                            .text(res.val)\n                    );\n                    $('#spos_customer').select2('val', res.id);\n                    $('#customerModal').modal('hide');\n                } else {\n                    $('#c-alert').html(res.msg);\n                    $('#c-alert').show();\n                }\n            },\n            error: function() {\n                bootbox.alert(lang.customer_request_failed);\n                return false;\n            },\n        });\n        return false;\n    });\n\n    $('#customerModal').on('hidden.bs.modal', function(e) {\n        $('#c-alert').hide();\n        $('#cname').val('');\n        $('#cemail').val('');\n        $('#cphone').val('');\n        $('#cf1').val('');\n        $('#cf2').val('');\n    });\n});\n\nfunction display_keyboards() {\n    if (!jQuery.browser.mobile) {\n        $('.kb-text').keyboard({\n            autoAccept: true,\n            alwaysOpen: false,\n            openOn: 'focus',\n            usePreview: false,\n            // layout: 'qwerty',\n            layout: 'custom',\n            display: {\n                bksp: '\\u2190',\n                accept: 'return',\n                default: 'ABC',\n                meta1: '123',\n                meta2: '#+=',\n            },\n            customLayout: {\n                default: [\n                    'q w e r t y u i o p {bksp}',\n                    'a s d f g h j k l {enter}',\n                    '{s} z x c v b n m , . {s}',\n                    '{meta1} {space} {cancel} {accept}',\n                ],\n                shift: [\n                    'Q W E R T Y U I O P {bksp}',\n                    'A S D F G H J K L {enter}',\n                    '{s} Z X C V B N M / ? {s}',\n                    '{meta1} {space} {meta1} {accept}',\n                ],\n                meta1: [\n                    '1 2 3 4 5 6 7 8 9 0 {bksp}',\n                    '- / : ; ( ) \\u20ac & @ {enter}',\n                    '{meta2} . , ? ! \\' \" {meta2}',\n                    '{default} {space} {default} {accept}',\n                ],\n                meta2: [\n                    '[ ] { } # % ^ * + = {bksp}',\n                    '_ \\\\ | &lt; &gt; $ \\u00a3 \\u00a5 {enter}',\n                    '{meta1} ~ . , ? ! \\' \" {meta1}',\n                    '{default} {space} {default} {accept}',\n                ],\n            },\n        });\n\n        $('.kb-pad').keyboard({\n            restrictInput: true,\n            preventPaste: true,\n            autoAccept: true,\n            alwaysOpen: false,\n            openOn: 'click',\n            usePreview: false,\n            layout: 'costom',\n            display: {\n                b: '\\u2190:Backspace',\n            },\n            customLayout: {\n                default: ['1 2 3 {b}', '4 5 6 . {clear}', '7 8 9 0 %', '{accept} {cancel}'],\n            },\n        });\n    }\n}\n\nfunction calTax() {\n    var ts = get('spos_tax') ? get('spos_tax') : $('#tax_val').val();\n    if (ts.indexOf('%') !== -1) {\n        var pts = ts.split('%');\n        order_tax = ((total - order_discount) * parseFloat(pts[0])) / 100;\n        $('#ts_con').text(formatMoney(order_tax));\n    } else {\n        order_tax = parseFloat(ts);\n        $('#ts_con').text(formatMoney(order_tax));\n    }\n    return order_tax;\n}\n\nfunction nav_pointer() {\n    var pp = p_page == 'n' ? 0 : p_page;\n    pp == 0 ? $('#previous').attr('disabled', true) : $('#previous').attr('disabled', false);\n    pp + pro_limit > tcp ? $('#next').attr('disabled', true) : $('#next').attr('disabled', false);\n}\n\nfunction Popup(data) {\n    createWin(data).then(function(w) {\n        w.close();\n    });\n}\nfunction createWin(data) {\n    return new Promise(function(resolve) {\n        var d =\n            '<!DOCTYPE html><html><head><title>Print</title><link rel=\"stylesheet\" href=\"' +\n            assets +\n            'bootstrap/css/bootstrap.min.css\" type=\"text/css\" /></head><body>' +\n            data +\n            '<script type=\"text/javascript\">window.print();</script></body></html>';\n        var mywindow = window.open(d, 'spos_print', 'height=500,width=300');\n        mywindow.document.write(d);\n        setTimeout(function() {\n            resolve(mywindow);\n        }, 20);\n    });\n}\n\n$(document).ready(function($) {\n    window.setTimeout(function() {\n        $('.alerts').slideUp();\n    }, 15000);\n    $('.alerts').on('click', function(e) {\n        $(this).slideUp();\n    });\n    $('#list-table-div').slimScroll({ start: 'bottom' });\n    $('#category-sidebar-menu').slimScroll({ width: '100%' });\n    $('.items').slimScroll({});\n});\n\nfunction posScreen() {\n    var wh = $(window).height(),\n        total_dh = $('#totaldiv').height(),\n        buttons_dh = $('.botbuttons').height(),\n        left_top_dh = $('#lefttop').outerHeight();\n    var items_dh = wh - 120,\n        list_table_dh = wh - 185 - left_top_dh - total_dh - buttons_dh;\n    $('#right-col').height(wh - 100);\n    $('.items').height(items_dh > 400 ? items_dh : 400);\n    $('#list-table-div').height(list_table_dh);\n}\n\nfunction printLine(str) {\n    var size = parseInt(Settings.char_per_line) - 4;\n    var len = str.length;\n    var res = str.split(':');\n    var newd = res[0];\n    for (i = 1; i < size - len; i++) {\n        newd += ' ';\n    }\n    newd += res[1];\n    return newd;\n}\n\n$(window).bind('resize', posScreen);\n\nfunction read_card() {}\n\n$.extend($.keyboard.keyaction, {\n    enter: function(base) {\n        if (base.$el.is('textarea')) {\n            base.insertText('\\r\\n');\n        } else {\n            base.accept();\n        }\n    },\n});\n\n$(document).ready(function() {\n    posScreen();\n    if (Settings.display_kb == 1) {\n        display_keyboards();\n    }\n    nav_pointer();\n    loadItems();\n    read_card();\n\n    $('.swipe')\n        .keypress(function(e) {\n            var TrackData = $(this).val() ? $(this).val() : '';\n            if (TrackData != '') {\n                if (e.keyCode == 13) {\n                    e.preventDefault();\n                    var p = new SwipeParserObj(TrackData);\n\n                    if (p.hasTrack1) {\n                        var CardType = null;\n                        var ccn1 = p.account.charAt(0);\n                        if (ccn1 == 4) CardType = 'Visa';\n                        else if (ccn1 == 5) CardType = 'MasterCard';\n                        else if (ccn1 == 3) CardType = 'Amex';\n                        else if (ccn1 == 6) CardType = 'Discover';\n                        else CardType = 'Visa';\n\n                        $('#pcc_no')\n                            .val(p.account)\n                            .change();\n                        $('#pcc_holder')\n                            .val(p.account_name)\n                            .change();\n                        $('#pcc_month')\n                            .val(p.exp_month)\n                            .change();\n                        $('#pcc_year')\n                            .val(p.exp_year)\n                            .change();\n                        $('#pcc_cvv2').val('');\n                        $('#pcc_type').select2('val', CardType);\n                    } else {\n                        $('#pcc_no')\n                            .val('')\n                            .change();\n                        $('#pcc_holder')\n                            .val('')\n                            .change();\n                        $('#pcc_month')\n                            .val('')\n                            .change();\n                        $('#pcc_year')\n                            .val('')\n                            .change();\n                        $('#pcc_cvv2')\n                            .val('')\n                            .change();\n                        $('#pcc_type')\n                            .val('')\n                            .change();\n                    }\n\n                    $('#pcc_cvv2').focus();\n                }\n            }\n        })\n        .blur(function(e) {\n            $(this).val('');\n        })\n        .focus(function(e) {\n            $(this).val('');\n        });\n\n    $(document).on('blur', '#pcc_no', function() {\n        var cn = $(this).val();\n        var ccn1 = cn.charAt(0);\n        if (ccn1 == 4) CardType = 'Visa';\n        else if (ccn1 == 5) CardType = 'MasterCard';\n        else if (ccn1 == 3) CardType = 'Amex';\n        else if (ccn1 == 6) CardType = 'Discover';\n        else CardType = 'Visa';\n\n        $('#pcc_type').select2('val', CardType);\n    });\n\n    $('.modal').on('hidden.bs.modal', function() {\n        $(this).removeData('bs.modal');\n    });\n    $('#clearLS').click(function(event) {\n        bootbox.confirm(lang.r_u_sure, function(result) {\n            if (result == true) {\n                localStorage.clear();\n                location.reload();\n            }\n        });\n        return false;\n    });\n\n    if (Settings.focus_add_item != '') {\n        shortcut.add(\n            Settings.focus_add_item,\n            function() {\n                $('#add_item').focus();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.add_customer != '') {\n        shortcut.add(\n            Settings.add_customer,\n            function() {\n                $('#add-customer').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.toggle_category_slider != '') {\n        shortcut.add(\n            Settings.toggle_category_slider,\n            function() {\n                $('[data-toggle=\"control-sidebar\"]').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.cancel_sale != '') {\n        shortcut.add(\n            Settings.cancel_sale,\n            function() {\n                $('#reset').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.suspend_sale != '') {\n        shortcut.add(\n            Settings.suspend_sale,\n            function() {\n                $('#suspend').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.print_order != '') {\n        shortcut.add(\n            Settings.print_order,\n            function() {\n                $('#print_order').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.print_bill != '') {\n        shortcut.add(\n            Settings.print_bill,\n            function() {\n                $('#print_bill').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.finalize_sale != '') {\n        shortcut.add(\n            Settings.finalize_sale,\n            function() {\n                $('#payment').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.today_sale != '') {\n        shortcut.add(\n            Settings.today_sale,\n            function() {\n                $('#today_sale').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.open_hold_bills != '') {\n        shortcut.add(\n            Settings.open_hold_bills,\n            function() {\n                $('#opened_bills').trigger('click');\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n    if (Settings.close_register != '') {\n        shortcut.add(\n            Settings.close_register,\n            function() {\n                $('#close_register').click();\n            },\n            { type: 'keydown', propagate: false, target: document }\n        );\n    }\n});\n$.fn.focusToEnd = function() {\n    return this.each(function() {\n        var v = $(this).val();\n        $(this)\n            .focus()\n            .val('')\n            .val(v);\n    });\n};\n$.ajaxSetup({ cache: false, headers: { 'cache-control': 'no-cache' } });\n"]}